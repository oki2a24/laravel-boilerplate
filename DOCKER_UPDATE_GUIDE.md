### **【指示書】Docker環境のバージョンアップ手順**

**目的:**
このリポジトリのDocker環境（ベースイメージおよび内包するaptパッケージ）を最新版に更新する。

---

### **最新バージョンの特定方法**

更新先の「最新版」を特定する方法は以下の通りです。

1.  **Dockerイメージ (例: `postgres`)**
    *   **Docker Hub** を確認するのが最も確実です。
    *   Docker Hubの公式ページ（例: `https://hub.docker.com/_/postgres`）にアクセスし、「Tags」タブで使用可能なバージョン一覧を確認します。ここで、プロジェクトの形式に合った最新のタグ（例: `16.3`）を見つけます。

2.  **apt パッケージ (例: `git`)**
    *   Dockerfileが使用しているOS（このプロジェクトの場合はDebian）のパッケージリストで確認します。
    *   Debianの公式パッケージ検索サイト（`https://packages.debian.org/`）などでパッケージ名を検索し、安定版（stable）として提供されているバージョンを確認します。

---

### **手順**

1.  **現状の確認:**
    *   `git diff HEAD` を実行し、現在加えられている変更（特にバージョン番号）を確認する。
    *   `docker/php/Dockerfile` と `docker/postgres/Dockerfile` の内容を読み込み、現在のバージョン指定方法を把握する。

2.  **バージョニング方針の適用:**
    以下の2つの方針に従って、各ファイルのバージョン番号を修正する。

    *   **方針1: Dockerイメージ (`FROM`命令)**
        *   **ルール:** `composer`, `php`, `postgres` などのベースイメージは、**既存のバージョン形式（例: `X.Y.Z` や `X.Y`）を維持したまま**、最新のバージョンに更新する。
        *   **例:**
            *   `composer:2.4.4` → `composer:2.8.12`
            *   `postgres:14.5` → `postgres:16.3`
            *   `php:8.2.0-apache` → `php:8.3-apache`

    *   **方針2: `apt` パッケージ**
        *   **ルール:** `docker/php/Dockerfile`内で`apt-get install`を使ってインストールされるライブラリは、すべて**メジャーバージョンで固定 (`X.*`)** する。
        *   **例:**
            *   `git=1:2.47.*` → `git=1:2.*`
            *   `nodejs=20.19.*` → `nodejs=20.*`
            *   `libicu-dev=76.1.*` → `libicu-dev=76.*`
            *   `supervisor=4.2.*` → `supervisor=4.*`

3.  **修正の実行:**
    *   `replace` ツールを使い、上記の方針に基づいて `docker/php/Dockerfile` の内容を修正する。ファイル全体を一度に書き換える方法を推奨する。

4.  **最終確認:**
    *   再度 `git diff HEAD` を実行し、`apt` パッケージがすべて `X.*` の形式になっていること、およびDockerイメージのバージョンが意図通りに更新されていることを確認する。